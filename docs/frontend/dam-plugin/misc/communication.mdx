---
sidebar_position: 1
title: 数据通信
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

## Iframe plugin

iframe 和主 App 之间通过 postMessage 进行通信。

## 事件

### ready

你的 iframe 应用加载完成之后，向主应用发送 ready 事件，主应用收到 ready 事件后会立即 iframe 应用发送 props 事件，传递数据。之后当 props 更新后，会再次发送 props 事件，传递新的数据。

#### 数据类型

```typescript
interface EventReady {
  event: 'ready';
}
```

#### 例子

```typescript
// 确保你的应用已经加载完成。
// 比如在react里可以在`useEffect`里执行，
// 在vue里可以在`onMounted`里执行。
// 以及确保你的应用被嵌入在 iframe 中
if (self !== parent) {
  window.addEventListener('message', (e) => {
    if (e.data.event === 'props') {
      // ...
    }
  });

  window.postMessage(
    {
      event: 'ready',
    },
    '*',
  );
}
```

### props

#### 数据类型

```typescript
interface EventProps<SlotProps> {
  event: 'props';
  data: SlotProps;
}
```

#### 例子

```typescript
// 确保你的应用已经加载完成。
// 比如在react里可以在`useEffect`里执行，
// 在vue里可以在`onMounted`里执行。
// 以及确保你的应用被嵌入在 iframe 中
if (self !== parent) {
  window.addEventListener('message', (e) => {
    if (e.data.event === 'props') {
      // ...
    }
  });

  window.postMessage(
    {
      event: 'ready',
    },
    '*',
  );
}
```
