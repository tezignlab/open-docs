(self.webpackChunktezign_open_docs=self.webpackChunktezign_open_docs||[]).push([[8369],{2651:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>d,default:()=>v,frontMatter:()=>p,metadata:()=>m,toc:()=>g});var a=n(1163),r=n(9496),o=n(9613),i=n(7533),l=n(5329);const c=n(5778);function s(){const[e,t]=(0,r.useState)(""),[n,a]=(0,r.useState)(""),[o,i]=(0,r.useState)(""),[l,s]=(0,r.useState)(""),p=(e,t,n)=>{if(!t||!n||!e)return;const r=function(e,t,n){const a=c.enc.Utf8.parse(t),r=c.enc.Utf8.parse(n);return c.AES.encrypt(e,a,{iv:r,padding:c.pad.Pkcs7,mode:c.mode.CBC}).toString()}(e,t,n);console.log(r),a(r)},d=(e,n,a)=>{if(!n||!a||!e)return;const r=function(e,t,n){const a=c.enc.Utf8.parse(t),r=c.enc.Utf8.parse(n);return c.AES.decrypt(e,a,{iv:r,padding:c.pad.Pkcs7,mode:c.mode.CBC}).toString(c.enc.Utf8)}(e,n,a);console.log(r),t(r)};return r.createElement("div",null,r.createElement("p",null,"Input Encryption ",r.createElement("br",null),r.createElement("textarea",{value:e,onChange:e=>{t(e.target.value),p(e.target.value,o,l)},className:"w-full h-36 border-gray-300 p-4 rounded-md"})),r.createElement("p",null,"aesKey:"," ",r.createElement("input",{value:o,onChange:t=>{i(t.target.value),p(e,t.target.value,l)},className:"w-200 p-2 rounded-md border-gray-300 border-solid"})),r.createElement("p",null,"aesIv:"," ",r.createElement("input",{value:l,onChange:t=>{s(t.target.value),p(e,o,t.target.value)},className:"w-200 p-2 rounded-md border-gray-300 border-solid"})),r.createElement("p",null,"Output Encryption ",r.createElement("br",null),r.createElement("textarea",{value:n,onChange:e=>{a(e.target.value),d(e.target.value,o,l)},className:"w-full h-36 border-gray-300 p-4 rounded-md"})))}const p={sidebar_position:1},d="\u6388\u6743",m={unversionedId:"common/authorize",id:"common/authorize",title:"\u6388\u6743",description:"\u901a\u8fc7 iframe \u8bbf\u95ee\u76f8\u5173\u7684\u5f00\u653e\u7ec4\u4ef6\uff0c\u4f60\u9700\u8981\u5148\u8fdb\u884c\u6388\u6743\uff0c\u6388\u6743\u6210\u529f\u540e\uff0c\u624d\u80fd\u8bbf\u95ee\u5230\u76f8\u5173\u7684\u5f00\u653e\u7ec4\u4ef6\u3002",source:"@site/docs/frontend/common/authorize.mdx",sourceDirName:"common",slug:"/common/authorize",permalink:"/docs/frontend/common/authorize",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"\u901a\u7528\u6d41\u7a0b",permalink:"/docs/frontend/category/common"},next:{title:"\u7d20\u6750\u9009\u62e9\u5668",permalink:"/docs/frontend/category/asset-selector"}},u={},g=[{value:"\u6388\u6743\u6d41\u7a0b",id:"\u6388\u6743\u6d41\u7a0b",level:2},{value:"Example",id:"example",level:2},{value:"\u9a8c\u8bc1",id:"\u9a8c\u8bc1",level:2}],y={toc:g},S="wrapper";function v(e){let{components:t,...n}=e;return(0,o.kt)(S,(0,a.Z)({},y,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"\u6388\u6743"},"\u6388\u6743"),(0,o.kt)("p",null,"\u901a\u8fc7 iframe \u8bbf\u95ee\u76f8\u5173\u7684\u5f00\u653e\u7ec4\u4ef6\uff0c\u4f60\u9700\u8981\u5148\u8fdb\u884c\u6388\u6743\uff0c\u6388\u6743\u6210\u529f\u540e\uff0c\u624d\u80fd\u8bbf\u95ee\u5230\u76f8\u5173\u7684\u5f00\u653e\u7ec4\u4ef6\u3002"),(0,o.kt)("h2",{id:"\u6388\u6743\u6d41\u7a0b"},"\u6388\u6743\u6d41\u7a0b"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u5411\u7279\u8d5e\u7533\u8bf7\uff1a",(0,o.kt)("strong",{parentName:"li"},"authUrl, aesKey, aesIv"),"\uff0c\u5e76\u6839\u636e\u5b9e\u9645\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u54a8\u8be2\u4f7f\u7528\u7684\u79df\u6237\u57df\u540d\uff0c\u90ae\u7bb1/\u624b\u673a\u7b49\u4fe1\u606f\u3002"),(0,o.kt)("li",{parentName:"ol"},"SSO \u8ba4\u8bc1\u94fe\u63a5\u683c\u5f0f\uff1a",(0,o.kt)("inlineCode",{parentName:"li"},"{authUrl}?aesUserInfo={encodeURIComponent(\u7ecf\u8fc7 aesKey \u52a0\u5bc6\u7684\u7528\u6237\u4fe1\u606f)}&targetUrl={encodeURIComponent(\u8ba4\u8bc1\u6210\u529f\u91cd\u5b9a\u5411\u5730\u5740)}"))),(0,o.kt)("p",null,"\u52a0\u5bc6\u7b97\u6cd5\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"AES. \u6570\u636e\u586b\u5145\u65b9\u5f0f: ",(0,o.kt)("inlineCode",{parentName:"li"},"AES/CBC/PKCS5Padding"))),(0,o.kt)("p",null,"\u52a0\u5bc6\u5b57\u6bb5\u4fe1\u606f\uff0c\u4e3e\u4f8b\u5982\u4e0b\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "loginEmail": "test@demo.com",\n  "domain": "test.demo.com",\n  "encryptTime": "2024-04-17 19:38:32.430" // \u5f53\u524d\u65f6\u95f4\uff0cUTC\u683c\u5f0f\n}\n')),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("inlineCode",{parentName:"p"},"domain")," \u4e3a\u5ba2\u6237\u5185\u5bb9\u4e2d\u53f0\uff08DAM\uff09\u7684\u57df\u540d")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"sso url \u4e2d\u7684\u53c2\u6570\u9700\u8981\u8fdb\u884c encodeURIComponent \u5904\u7406")),(0,o.kt)("h2",{id:"example"},"Example"),(0,o.kt)("p",null,"\u52a0\u5bc6\u4fe1\u606f\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,o.kt)(i.Z,{mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"vanilla",label:"Java",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'import com.alibaba.fastjson.JSONObject;\nimport org.apache.commons.codec.binary.Base64;\n\nimport javax.crypto.Cipher;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\nimport java.net.URLDecoder;\nimport java.net.URLEncoder;\nimport java.nio.charset.StandardCharsets;\nimport java.util.Date;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\n\n/**\n * AES\u52a0\u5bc6\u5de5\u5177\n */\npublic class AESUtilV2 {\n    private static final String KEY_ALGORITHM = "AES";\n    // CBC mode\n    private static final String ENCRYPT_MODE_CBC = "AES/CBC/PKCS5Padding";\n\n    /**\n     * AES \u52a0\u5bc6\u64cd\u4f5c\n     *\n     * @param plainText \u660e\u6587\n     * @param key       \u5bc6\u94a5\n     * @param iv        \u5411\u91cf\n     * @return \u8fd4\u56deBase64\u8f6c\u7801\u540e\u7684\u52a0\u5bc6\u6570\u636e\n     */\n    public static String encryptAndEncode(String plainText, String key, String iv) {\n        try {\n            byte[] bytePlainText = plainText.getBytes(StandardCharsets.UTF_8);\n            byte[] byteKey = key.getBytes(StandardCharsets.UTF_8);\n            byte[] byteIV = iv.getBytes(StandardCharsets.UTF_8);\n\n            Cipher cipher = Cipher.getInstance(ENCRYPT_MODE_CBC);// \u521b\u5efa\u5bc6\u7801\u5668\n            IvParameterSpec ivParam = new IvParameterSpec(byteIV);\n            SecretKeySpec secretKey = new SecretKeySpec(byteKey, KEY_ALGORITHM);\n            cipher.init(Cipher.ENCRYPT_MODE, secretKey, ivParam);// \u521d\u59cb\u5316\u4e3a\u52a0\u5bc6\u6a21\u5f0f\u7684\u5bc6\u7801\u5668\n            byte[] result = cipher.doFinal(bytePlainText);// \u52a0\u5bc6\n            String encryptString = Base64.encodeBase64String(result);\n            return encryptString;\n        } catch (Exception ex) {\n            Logger.getLogger(AESUtilV2.class.getName()).log(Level.SEVERE, null, ex);\n        }\n\n        return null;\n    }\n\n    /**\n     * AES \u89e3\u5bc6\u64cd\u4f5c\n     *\n     * @param ciphertext \u5bc6\u6587\n     * @param key        \u5bc6\u94a5\n     * @param iv         \u5411\u91cf\n     * @return \u660e\u6587\n     */\n    public static String decryptAndDecode(String ciphertext, String key, String iv) {\n        try {\n            ciphertext = URLDecoder.decode(ciphertext, StandardCharsets.UTF_8.name());\n            byte[] byteKey = key.getBytes(StandardCharsets.UTF_8);\n            byte[] byteIV = iv.getBytes(StandardCharsets.UTF_8);\n            Cipher cipher = Cipher.getInstance(ENCRYPT_MODE_CBC);\n            IvParameterSpec ivParam = new IvParameterSpec(byteIV);\n            SecretKeySpec secretKey = new SecretKeySpec(byteKey, KEY_ALGORITHM);\n            //\u4f7f\u7528\u5bc6\u94a5\u3001\u5411\u91cf\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u8bbe\u7f6e\u4e3a\u89e3\u5bc6\u6a21\u5f0f\n            cipher.init(Cipher.DECRYPT_MODE, secretKey, ivParam);\n            //\u6267\u884c\u64cd\u4f5c\n            byte[] result = cipher.doFinal(Base64.decodeBase64(ciphertext));\n            return new String(result, StandardCharsets.UTF_8);\n        } catch (Exception ex) {\n            Logger.getLogger(AESUtilV2.class.getName()).log(Level.SEVERE, null, ex);\n        }\n\n        return null;\n    }\n\n    public static void main(String[] args) {\n        JSONObject jo = new JSONObject();\n        // \u7528\u6237\u90ae\u7bb1\u548c\u624b\u673a\u53f7\uff0c\u4e8c\u8005\u5fc5\u9009\u5176\u4e00\n        jo.putIfAbsent("loginEmail", "wangfeng@tezign.com");\n        jo.putIfAbsent("loginPhone", "15705273217");\n        // \u79df\u6237\u57df\u540d\n        jo.putIfAbsent("domain", "vms-t13.tezign.com");\n        // \u52a0\u5bc6\u65f6\u95f4\uff0c\u8ba4\u8bc1\u670d\u52a1\u7aef\u4f1a\u6839\u636e\u8be5\u65f6\u95f4\u6233\u8fdb\u884c\u5931\u6548\u6821\u9a8c\n        jo.putIfAbsent("encryptTime", new Date());\n        // \u7528\u6237\u540d\uff0c\u53ef\u9009\n        jo.putIfAbsent("username", "levi.wang");\n\n        // \u52a0\u5bc6\u79d8\u94a5\u548c\u504f\u79fb\u5411\u91cf\uff0c\u7531\u7279\u8d5e\u5bf9\u63a5\u4eba\u5458\u63d0\u4f9b\n        String aesKey = "1234567890abcdef";\n        String aesIv = "1234567890abcdef";\n\n        String ss = jo.toString();\n        String aa = encryptAndEncode(ss, aesKey, aesIv);\n        System.out.println("\u52a0\u5bc6======  " + aa);\n\n        String bb = decryptAndDecode(aa, aesKey, aesIv);\n        System.out.println("\u89e3\u5bc6======  " + bb);\n    }\n}\n')))),(0,o.kt)("h2",{id:"\u9a8c\u8bc1"},"\u9a8c\u8bc1"),(0,o.kt)(s,{mdxType:"EncryptComponent"}))}v.isMDXComponent=!0},1054:()=>{}}]);